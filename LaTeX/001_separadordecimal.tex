% !TEX TS-program = lualatex
\documentclass{article}
\usepackage{amsmath}


\usepackage{luacode}
\begin{luacode}
ok_to_process = true
function ez_read ( line )
  if string.find ( line , "\\begin{[vV]erbatim}" ) then
     ok_to_process = false
     return line
  elseif string.find ( line , "\\end{[vV]erbatim}" ) then
     ok_to_process = true
     return line
  else
    if ok_to_process then
      x = line:gsub ( "([%.]-)(%d+)", function ( back, text )
        if back ~= "" then
          return back..text
        end
        text = string.gsub ( text , "(%d?%d?%d)(%d%d%d)(%d%d%d)(%d%d%d)",
                                    "%1\\,%2\\,%3\\,%4" )
        text = string.gsub ( text , "(%d?%d?%d)(%d%d%d)(%d%d%d)",
                                    "%1\\,%2\\,%3" )
        text = string.gsub ( text , "(%d?%d%d)(%d%d%d)", "%1\\,%2" )
        return text
      end)
      return x
    end
  end
end
luatexbase.add_to_callback( "process_input_buffer", ez_read, "ez_read")
\end{luacode}

\begin{document}    
123456789012, 123456789, 123456, 12345

But: 1234 --- no thinspace after ``1''

$123.456.123.456.789, 0.12345, 123456+23423432$

\begin{equation*}
\sqrt{x^2+100.000}
\end{equation*}

\end{document}
